import{api as n}from"./axios-CInKXjoT.js";import{Y as l}from"./index-Du_3Vesk.js";import{e as f,u as m}from"./auth-dzuJufgy.js";const i=async(e,t,s,a)=>{try{let r=t;if(r.startsWith("/")||(r="/"+r),r="http://localhost:5001/api"+r,e==="post")return await n.post(r,s,a);if(e==="put")return await n.put(r,s,a);if(e==="get")return await n.get(r,a);if(e==="delete")return await n.delete(r,a)}catch(r){f(`Error in ${e}`,t,JSON.parse(JSON.stringify(r)));let u="";if(r.response&&r.response.data){let o=r.response.data;if(o instanceof Blob&&(o=JSON.parse(await o.text())),u=o.detail,typeof o.detail=="string"&&o.detail.includes("<class 'sqlalchemy.exc.IntegrityError'>")&&(u="You must delete all files associated with this app before deleting the app. Please click on the settings icon to enter into the app settings and delete the files."),o.detail==="Unauthorized")return f("Unauthorized access -> trigger logout"),m().logout(),!1}return l.create({title:"Error",message:u,style:"min-width: 50vw",color:"negative",html:!1}),!1}},c=(e,t={})=>(t.responseType="blob",i("get",e,{},t)),y=(e,t,s={})=>(s=s||{},s.responseType="blob",i("post",e,t,s)),w=(e,t)=>i("get",e,{},t),g=(e,t,s)=>i("put",e,t,s),h=(e,t,s)=>i("post",e,t,s),d=(e,t)=>i("delete",e,{},t),$={delete:async(e,t)=>{d(`/files/${e}`),t&&t()},rename:(e,t,s="")=>{l.create({title:"Rename",message:"Enter new filename",prompt:{model:s,type:"text"}}).onOk(async a=>{a!==s&&(await p.put(`/files/${e}`,{name:a}),t&&t())})}},x={delete:async(e,t)=>{p.delete(`/results/${e}`),t&&t()},report:async(e,t,s)=>{p.post(`/results/${e}/report`,{message:t}),s&&s()},rename:(e,t,s)=>{l.create({title:"Rename",message:"Enter new filename",prompt:{model:s,type:"text"}}).onOk(async a=>{a!==s&&(await p.put(`/results/${e}`,{name:a}),t&&t())})}},E={promptPassword:e=>l.create({title:e||"Password",message:"Enter password",prompt:{model:"",type:"password"}})},p={admin:E,file:$,job:x,get:w,put:g,post:h,getBlob:c,postBlob:y,delete:d};export{p as a};

import{Q as B,a as C}from"./QTable-BfwWHyg7.js";import{d as Q,b as y,Z as g,ae as x,a6 as _,x as i,I as l,v as r,u as a,ab as q,p as j,ac as F,aa as N,af as p,Q as U}from"./index-Du_3Vesk.js";import{Q as $}from"./QForm-DvVOEjuU.js";import{u as z}from"./use-quasar-IjjsIl5B.js";import{_ as b}from"./ButtonWithTooltip.vue_vue_type_script_setup_true_lang-GHMn38hu.js";import{c as D,a as f}from"./utils-BH9nH3nv.js";import{a as n}from"./api-C-PlNVV_.js";import"./QList-C_17cm5H.js";import"./QChip-H_55yLGh.js";import"./QItem-DtTTb-ec.js";import"./QItemSection-CpQhvstY.js";import"./QItemLabel-CcbGqN9l.js";import"./QTooltip-CsZJC6ig.js";import"./selection-BDLl0KOp.js";import"./format-CJebrXOQ.js";import"./auth-dzuJufgy.js";import"./pinia-BXXl-SmG.js";import"./axios-CInKXjoT.js";import"./index-3fevySbJ.js";const T={class:"row q-ma-md"},I={class:"row q-ma-md items-center",flat:""},J={class:"row"},le=Q({__name:"BackupsComponent",setup(K){const c=z(),m=y([]),t=g({name:"",database:!0,files:!0,jobs:!0}),k=[{label:"Timestamp",field:"timestamp",name:"timestamp"},{label:"Name",field:"name",name:"name"},{label:"Database",field:"database",name:"database"},{label:"Jobs",field:"jobs",name:"jobs"},{label:"Files",field:"files",name:"files"},{label:"Size",field:"size",name:"size"},{label:"Actions",field:"actions",name:"actions"}],u=async()=>{m.value=(await n.get("/admin/backup")).data},v=async()=>{const o=await n.post("/admin/backup/create",D(t));o.data!==void 0&&c.notify(`Created backup ${o.data}`),u()},V=async(o,e)=>{(e.ctrlKey||await f("delete backup",o.name))&&(m.value.splice(m.value.indexOf(o),1),n.post("/admin/backup/delete",{timestamp:o.timestamp}))},w=async(o,e)=>{(e.ctrlKey||await f("restore backup ",o.name))&&(await n.post("/admin/backup/restore",{timestamp:o.timestamp}),c.notify(`Restored backup ${o.name}`))};return x(u),(o,e)=>(j(),_(q,null,[e[5]||(e[5]=i("div",{class:"row q-ma-md text-h4"},"Backups",-1)),i("div",T,[l(B,{rows:a(m),columns:k,pagination:{rowsPerPage:10},"hide-bottom":a(m).length<=10},{"body-cell-actions":r(({row:s})=>[l(C,null,{default:r(()=>[l(b,{tooltip:"Restore",icon:"mdi-restore",color:"accent",onClick:d=>w(s,d)},null,8,["onClick"]),l(b,{tooltip:"Delete",icon:"mdi-delete",color:"negative",onClick:d=>V(s,d)},null,8,["onClick"])]),_:2},1024)]),_:1},8,["rows","hide-bottom"])]),l(F),i("div",I,[e[4]||(e[4]=i("div",{class:"text-h6 q-mr-md"},"New backup:",-1)),i("div",null,[l($,null,{default:r(()=>[i("div",J,[l(N,{"item-aligned":"",dense:"",class:"col",modelValue:a(t).name,"onUpdate:modelValue":e[0]||(e[0]=s=>a(t).name=s),required:"",label:"Name"},null,8,["modelValue"]),l(p,{class:"col",modelValue:a(t).database,"onUpdate:modelValue":e[1]||(e[1]=s=>a(t).database=s),dense:"",label:"Database"},null,8,["modelValue"]),l(p,{class:"col",modelValue:a(t).files,"onUpdate:modelValue":e[2]||(e[2]=s=>a(t).files=s),dense:"",label:"Files"},null,8,["modelValue"]),l(p,{class:"col",modelValue:a(t).jobs,"onUpdate:modelValue":e[3]||(e[3]=s=>a(t).jobs=s),dense:"",label:"Jobs"},null,8,["modelValue"]),l(U,{class:"col q-ma-md",disabled:!a(t).database&&!a(t).files&&!a(t).jobs||!a(t).name,color:"positive",label:"Create",onClick:v},null,8,["disabled"])])]),_:1})])])],64))}});export{le as default};

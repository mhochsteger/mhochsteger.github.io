import{Q as te}from"./QChip-H_55yLGh.js";import{j as G,b as N,c as u,aW as ae,s as H,aR as ne,h as w,e as le,b0 as ie,b1 as re,b2 as oe,b3 as se,b4 as ue,b5 as ce,b6 as W,b7 as de,b8 as pe,aV as fe,d as me,at as C,ae as $,a6 as M,p as K,x as k,a as ve,u as R,I as O,ak as ge,al as he,v as be,y as ye,ab as _e,F as X}from"./index-Du_3Vesk.js";import{h as Fe}from"./format-CJebrXOQ.js";import{Q as xe,a as Se}from"./QInnerLoading-DfrxAtBn.js";import{e as Y}from"./auth-dzuJufgy.js";import{_ as Ce}from"./RecursiveComponent.vue_vue_type_script_setup_true_lang-CQmSpjAA.js";import{u as we}from"./remote_app-C7FrUm08.js";import"./pinia-BXXl-SmG.js";import"./jsoneditor.min-DkeLFdXe.js";import"./use-quasar-IjjsIl5B.js";import"./QResizeObserver-BmVOFGfH.js";import"./utils-BH9nH3nv.js";import"./api-C-PlNVV_.js";import"./axios-CInKXjoT.js";import"./index-3fevySbJ.js";function I(e,f,_,b){const r=[];return e.forEach(s=>{b(s)===!0?r.push(s):f.push({failedPropValidation:_,file:s})}),r}function T(e){e&&e.dataTransfer&&(e.dataTransfer.dropEffect="copy"),H(e)}const Ae={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},Ve=["rejected"];function ze({editable:e,dnd:f,getFileInput:_,addFilesToQueue:b}){const{props:r,emit:s,proxy:g}=G(),d=N(null),F=u(()=>r.accept!==void 0?r.accept.split(",").map(t=>(t=t.trim(),t==="*"?"*/":(t.endsWith("/*")&&(t=t.slice(0,t.length-1)),t.toUpperCase()))):null),S=u(()=>parseInt(r.maxFiles,10)),A=u(()=>parseInt(r.maxTotalSize,10));function V(t){if(e.value)if(t!==Object(t)&&(t={target:null}),t.target!==null&&t.target.matches('input[type="file"]')===!0)t.clientX===0&&t.clientY===0&&ae(t);else{const h=_();h&&h!==t.target&&h.click(t)}}function z(t){e.value&&t&&b(null,t)}function p(t,h,j,q){let n=Array.from(h||t.target.files);const v=[],x=()=>{v.length!==0&&s("rejected",v)};if(r.accept!==void 0&&F.value.indexOf("*/")===-1&&(n=I(n,v,"accept",l=>F.value.some(c=>l.type.toUpperCase().startsWith(c)||l.name.toUpperCase().endsWith(c))),n.length===0))return x();if(r.maxFileSize!==void 0){const l=parseInt(r.maxFileSize,10);if(n=I(n,v,"max-file-size",c=>c.size<=l),n.length===0)return x()}if(r.multiple!==!0&&n.length!==0&&(n=[n[0]]),n.forEach(l=>{l.__key=l.webkitRelativePath+l.lastModified+l.name+l.size}),q===!0){const l=j.map(c=>c.__key);n=I(n,v,"duplicate",c=>l.includes(c.__key)===!1)}if(n.length===0)return x();if(r.maxTotalSize!==void 0){let l=q===!0?j.reduce((c,L)=>c+L.size,0):0;if(n=I(n,v,"max-total-size",c=>(l+=c.size,l<=A.value)),n.length===0)return x()}if(typeof r.filter=="function"){const l=r.filter(n);n=I(n,v,"filter",c=>l.includes(c))}if(r.maxFiles!==void 0){let l=q===!0?j.length:0;if(n=I(n,v,"max-files",()=>(l++,l<=S.value)),n.length===0)return x()}if(x(),n.length!==0)return n}function o(t){T(t),f.value!==!0&&(f.value=!0)}function i(t){H(t),(t.relatedTarget!==null||ne.is.safari!==!0?t.relatedTarget!==d.value:document.elementsFromPoint(t.clientX,t.clientY).includes(d.value)===!1)===!0&&(f.value=!1)}function D(t){T(t);const h=t.dataTransfer.files;h.length!==0&&b(null,h),f.value=!1}function P(t){if(f.value===!0)return w("div",{ref:d,class:`q-${t}__dnd absolute-full`,onDragenter:T,onDragover:T,onDragleave:i,onDrop:D})}return Object.assign(g,{pickFiles:V,addFiles:z}),{pickFiles:V,addFiles:z,onDragover:o,onDragleave:i,processFiles:p,getDndNode:P,maxFilesNumber:S,maxTotalSizeNumber:A}}const Pe=le({name:"QFile",inheritAttrs:!1,props:{...oe,...re,...Ae,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...ie,...Ve],setup(e,{slots:f,emit:_,attrs:b}){const{proxy:r}=G(),s=se(),g=N(null),d=N(!1),F=ue(e),{pickFiles:S,onDragover:A,onDragleave:V,processFiles:z,getDndNode:p}=ze({editable:s.editable,dnd:d,getFileInput:B,addFilesToQueue:Q}),o=ce(e),i=u(()=>Object(e.modelValue)===e.modelValue?"length"in e.modelValue?Array.from(e.modelValue):[e.modelValue]:[]),D=u(()=>W(i.value)),P=u(()=>i.value.map(a=>a.name).join(", ")),t=u(()=>Fe(i.value.reduce((a,m)=>a+m.size,0))),h=u(()=>({totalSize:t.value,filesNumber:i.value.length,maxFiles:e.maxFiles})),j=u(()=>({tabindex:-1,type:"file",title:"",accept:e.accept,capture:e.capture,name:F.value,...b,id:s.targetUid.value,disabled:s.editable.value!==!0})),q=u(()=>"q-file q-field--auto-height"+(d.value===!0?" q-file--dnd":"")),n=u(()=>e.multiple===!0&&e.append===!0);function v(a){const m=i.value.slice();m.splice(a,1),l(m)}function x(a){const m=i.value.indexOf(a);m!==-1&&v(m)}function l(a){_("update:modelValue",e.multiple===!0?a:a[0])}function c(a){a.keyCode===13&&fe(a)}function L(a){(a.keyCode===13||a.keyCode===32)&&S(a)}function B(){return g.value}function Q(a,m){const y=z(a,m,i.value,n.value),U=B();U!=null&&(U.value=""),y!==void 0&&((e.multiple===!0?e.modelValue&&y.every(ee=>i.value.includes(ee)):e.modelValue===y[0])||l(n.value===!0?i.value.concat(y):y))}function E(){return[w("input",{class:[e.inputClass,"q-file__filler"],style:e.inputStyle})]}function J(){if(f.file!==void 0)return i.value.length===0?E():i.value.map((m,y)=>f.file({index:y,file:m,ref:this}));if(f.selected!==void 0)return i.value.length===0?E():f.selected({files:i.value,ref:this});if(e.useChips===!0)return i.value.length===0?E():i.value.map((m,y)=>w(te,{key:"file-"+y,removable:s.editable.value,dense:!0,textColor:e.color,tabindex:e.tabindex,onRemove:()=>{v(y)}},()=>w("span",{class:"ellipsis",textContent:m.name})));const a=e.displayValue!==void 0?e.displayValue:P.value;return a.length!==0?[w("div",{class:e.inputClass,style:e.inputStyle,textContent:a})]:E()}function Z(){const a={ref:g,...j.value,...o.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:Q};return e.multiple===!0&&(a.multiple=!0),w("input",a)}return Object.assign(s,{fieldClass:q,emitValue:l,hasValue:D,inputRef:g,innerValue:i,floatingLabel:u(()=>D.value===!0||W(e.displayValue)),computedCounter:u(()=>{if(e.counterLabel!==void 0)return e.counterLabel(h.value);const a=e.maxFiles;return`${i.value.length}${a!==void 0?" / "+a:""} (${t.value})`}),getControlChild:()=>p("file"),getControl:()=>{const a={ref:s.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:e.tabindex};return s.editable.value===!0&&Object.assign(a,{onDragover:A,onDragleave:V,onKeydown:c,onKeyup:L}),w("div",a,[Z()].concat(J()))}}),Object.assign(r,{removeAtIndex:v,removeFile:x,getNativeElement:()=>g.value}),de(r,"nativeEl",()=>g.value),pe(s)}}),ke={class:"row"},Ie={key:0,class:"q-pa-md column items-center transparent"},Ne={class:"row"},De={class:"col"},je={class:"fixed-center"},qe={style:{"text-align":"center","padding-top":"130px"}},He=me({__name:"StandalonePage",setup(e){u(()=>parseInt(C.currentRoute.value.query.backendPort)),u(()=>parseInt(C.currentRoute.value.query.websocketPort)).value&&C.replace({path:"/local",query:C.currentRoute.value.query}),u(()=>parseInt(C.currentRoute.value.query.webgpuWebsocketPort));const _=u(()=>C.currentRoute.value.query.codeUrl),b=u(()=>C.currentRoute.value.query.appId),r=async()=>{const o=await(await fetch("/get_available_applications")).json();return console.log("all apps",o),o[b.value]},s=we(),g=N({compId:null}),d=N(!1),F=N("Loading..."),S=async p=>{d.value=!0,F.value="Loading App...";try{const P=await(await(await(await s.runAppCode(p)).component)._get_my_wrapper_props)();P&&(g.value=P),d.value=!1}catch(o){Y("Error loading app",o),d.value=!1}},A=async()=>{if(!_.value)return;const p=await fetch(_.value).then(o=>o.text());await S(p)},V=async()=>{if(!b.value)return;const p=await r();console.log("Appdata",p),d.value=!0,F.value="Loading App...";try{const o=await s.loadApp(p);o&&(g.value=o),d.value=!1}catch(o){Y("Error loading app",o),d.value=!1}},z=async p=>{const o=await p.text();await S(o)};return X("remoteApp",s),X("traceEvent",()=>{}),$(A),$(V),(p,o)=>(K(),M(_e,null,[k("div",ke,[R(b)?ve("",!0):(K(),M("div",Ie,[O(Pe,{label:"Select or drop app code file","onUpdate:modelValue":z,filled:"",style:{"max-width":"300px"}})]))]),k("div",Ne,[k("div",De,[O(Ce,ge(he(R(g))),null,16)]),O(R(Se),{showing:R(d)},{default:be(()=>[k("div",null,[k("div",je,[O(xe,{size:"100px",color:"primary"})]),k("div",qe,ye(R(F)),1)])]),_:1},8,["showing"])])],64))}});export{He as default};
